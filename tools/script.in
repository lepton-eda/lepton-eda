#!/usr/bin/env sh
exec @GUILE@ -s "$0" "$@"
!#

;;; The eval-when() macro allows to suppress compilation warnings
;;; on not defined variables because it evaluates the code on the
;;; expand stage before compilation.  This allows us to get Scheme
;;; module load paths we need before compilation, thus eliminating
;;; warnings on loading the modules afterwards.
(eval-when (expand load eval)
  (define %m4-bindir "@leptonbindir@")
  (define %m4-abs-top-srcdir "@abs_top_srcdir@")
  (define %m4-lepton-data-dir "@leptondatadir@")

  ;; Check if the program runs from its installation directory.
  (define run-installed-program? #t)
  (if (and run-installed-program?
           (not (getenv "LIBLEPTON")))
      (begin
        (add-to-load-path "@LEPTON_SCHEME_DIR@")
        (set! %load-compiled-path (cons "@LEPTON_CCACHE_DIR@" %load-compiled-path)))
      (begin
        ;; Do nothing for now.
        #f)))

(use-modules (lepton m4))
